server:
  port: 8080
  tomcat:
    relaxed-path-chars: <,>,[,\,],^,`,{,|,}
    relaxed-query-chars: <,>,[,\,],^,`,{,|,}

spring:
  application:
    name: ai-assistant-toolbox
  
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://172.18.33.30:3306/study?createDatabaseIfNotExist=true&useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
    username: dbadmin
    password: i5HMGTSi@4Wa
    druid:
      initial-size: 5
      min-idle: 5
      max-active: 20
      max-wait: 60000
      time-between-eviction-runs-millis: 60000
      min-evictable-idle-time-millis: 300000
      validation-query: SELECT 1
      test-while-idle: true
      test-on-borrow: false
      test-on-return: false
  
  liquibase:
    enabled: true
    change-log: classpath:db/changelog/db.changelog-master.yaml
  
  servlet:
    multipart:
      enabled: true
      max-file-size: 10MB
      max-request-size: 10MB
  
  ai:
    openai:
      api-key: ${OPENAI_API_KEY:sk-pmcjozkvpmqsdkqmixtjtjylhvhqtznozqlyxnkgzdypmjhs}
      base-url: ${OPENAI_BASE_URL:https://api.siliconflow.cn}
    vectorstore:
      simple:
        path: uploads/vector-store
        dimension: 1024

# 文件上传配置
file:
  upload:
    path: uploads
    max-size: 10
    image-types: jpg,jpeg,png,gif,bmp,webp
    file-types: txt,pdf,doc,docx,xls,xlsx,csv,json,xml,md

# 文档切片配置
document:
  chunking:
    # 切片策略: 
    #   paragraph - 一个段落一块（推荐，保持段落完整性）
    #   smart - 智能段落切片（多个段落合并到目标大小）
    #   fixed - 固定大小切片（传统方式）
    strategy: paragraph
    # 目标块大小（字符数，仅在smart和fixed模式下使用）
    chunk-size: 1000
    # 块之间的重叠（字符数，仅在smart和fixed模式下使用）
    overlap: 200

# MyBatis-Plus configuration
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      id-type: assign_uuid
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# CORS configuration
cors:
  allowed-origins: http://localhost:5173,http://localhost:3000
  allowed-methods: GET,POST,PUT,DELETE,OPTIONS
  allowed-headers: "*"

# Logging
logging:
  level:
    com.ai.assistant: DEBUG
    org.springframework.ai: DEBUG
